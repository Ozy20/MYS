# 1. Use the specific Node version (matches your local environment)
FROM node:22-alpine

# 2. CREATE and CD into '/app'
# Any command after this line happens inside this folder.
WORKDIR /app

# 3. Copy only package files first
# We do this separate from the rest of the code to take advantage of Docker Caching.
# If you change your code but not your dependencies, Docker skips 'npm install' next time!
COPY backend/package*.json ./

# 4. Install dependencies
RUN npm install

# 5. Copy the rest of your backend code
# NOTE: In 'docker-compose', we will map a Volume over this.
# That means this COPY instruction is technically overwritten by your live code
# during development, but it's still required for the image to build successfully.
COPY backend/ .

# 6. Expose the port (Documentary only, tells us what port to open)
EXPOSE 3000

# 7. Start the app with a watcher
# 'nodemon' creates a wrapper that restarts the server when you save a file.
# Make sure your package.json scripts has: "dev": "nodemon server.js"
CMD ["npm", "run", "dev"]